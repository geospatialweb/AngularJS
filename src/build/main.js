!function(e){function r(r){for(var a,s,o=r[0],l=r[1],u=r[2],f=0,p=[];f<o.length;f++)s=o[f],n[s]&&p.push(n[s][0]),n[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(c&&c(r);p.length;)p.shift()();return i.push.apply(i,u||[]),t()}function t(){for(var e,r=0;r<i.length;r++){for(var t=i[r],a=!0,o=1;o<t.length;o++){var l=t[o];0!==n[l]&&(a=!1)}a&&(i.splice(r--,1),e=s(s.s=t[0]))}return e}var a={},n={1:0},i=[];function s(r){if(a[r])return a[r].exports;var t=a[r]={i:r,l:!1,exports:{}};return e[r].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=e,s.c=a,s.d=function(e,r,t){s.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:t})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(r,"a",r),r},s.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},s.p="";var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=r,o=o.slice();for(var u=0;u<o.length;u++)r(o[u]);var c=l;i.push([15,0]),t()}([function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={map:{accessToken:"pk.eyJ1IjoiZ2Vvc3BhdGlhbHdlYiIsImEiOiJ6WGdOUFRvIn0.GoVRwZq5EfVsLNGyCqgZTw",center:[-76.3,44.45],container:"map",control:{position:"top-left"},styles:{default:"mapbox://styles/mapbox/dark-v9",outdoors:"mapbox://styles/mapbox/outdoors-v9"},zoom:9},layers:{route:"/layers",biosphere:{layer:{id:"biosphere",type:"fill",source:{type:"geojson"},layout:{visibility:"visible"},paint:{"fill-color":"#090","fill-opacity":.3,"fill-outline-color":"#000"}},postgres:{table:"biosphere",fields:"name, description, ST_AsGeoJSON(geom)"}},office:{postgres:{table:"office",fields:"name, description, ST_AsGeoJSON(geom)"}},places:{postgres:{table:"places",fields:"name, description, ST_AsGeoJSON(geom)"}},trails:{layer:{id:"trails",type:"line",source:{type:"geojson"},layout:{visibility:"none"},paint:{"line-color":"#aa0000","line-width":2}},postgres:{table:"trails",fields:"name, description, lat, lng, ST_AsGeoJSON(geom)"}}},trails:{"Blue Mountain":{center:[-76.04,44.508],zoom:12},"Charleston Lake":{center:[-76.04,44.508],zoom:12},"Lemoine Point":{center:[-76.61,44.223],zoom:14},"Lyn Valley":{center:[-75.75,44.575],zoom:12},"Mac Johnson":{center:[-75.75,44.575],zoom:12},"Seeley's Bay":{center:[-76.22,44.485],zoom:13},selectedOption:"Select Trail"}}},,function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(r,t,a){return t&&e(r.prototype,t),a&&e(r,a),r}}();var n=function(){function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.$document=r,this.splashScreen=void 0}return a(e,[{key:"setSplashScreen",value:function(e){return this.splashScreen=e,!0}},{key:"addSplashScreen",value:function(){return this.splashScreen.addClass("visible"),!0}},{key:"removeSplashScreen",value:function(){return this.splashScreen.removeClass("visible"),!0}},{key:"hideSplashScreen",value:function(){return this.splashScreen.removeClass("active"),angular.element(this.$document[0].querySelectorAll("map-layer ul.layers li.biosphere div")).addClass("active"),!0}}]),e}();r.default=n,n.$inject=["$document"]},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(r,t,a){return t&&e(r.prototype,t),a&&e(r,a),r}}();var n=function(){function e(r,t,a){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.$document=r,this.mapService=t,this.markerService=a}return a(e,[{key:"addMarkers",value:function(e){var r=this;return this.markerService.markers[this.markerService.markersHash[e]].map(function(e){return e.addTo(r.mapService.map)}),!0}},{key:"removeMarkers",value:function(e){return this.markerService.markers[this.markerService.markersHash[e]].map(function(e){return e.remove()}),!0}},{key:"hideMarkers",value:function(){var e=this;return this.markerService.markers.map(function(r){var t=r[0].getElement().id;return angular.element(e.$document[0].querySelectorAll("div."+t+"-marker")).length&&(e.removeMarkers(t),r.hidden=!0),!0}),!0}},{key:"showMarkers",value:function(){var e=this;return this.markerService.markers.map(function(r){if(r.hidden){var t=r[0].getElement().id;e.addMarkers(t),r.hidden=!1}return!0}),!0}}]),e}();r.default=n,n.$inject=["$document","mapService","markerService"]},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a,n=function(){function e(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(r,t,a){return t&&e(r.prototype,t),a&&e(r,a),r}}(),i=t(1),s=(a=i)&&a.__esModule?a:{default:a};var o=function(){function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.markers=[],this.markersHash={}}return n(e,[{key:"createMarkersHash",value:function(){var e=this;return this.markers.map(function(r,t){var a=r[0].getElement();return e.markersHash[a.id]=t,!0}),!0}},{key:"setMarkers",value:function(e){var r=e.config.params.table;switch(r){case"office":var t=[];e.data.features.map(function(e){var a=document.createElement("div");return a.id=r,a.className=r+"-marker",t.push(new s.default.Marker(a).setLngLat(e.geometry.coordinates).setPopup(new s.default.Popup({offset:15}).setHTML("<b>"+e.properties.name+"</b><br>"+e.properties.description))),!0}),this.markers.push(t);break;case"places":var a=[];e.data.features.map(function(e){var t=document.createElement("div");return t.id=r,t.className=r+"-marker",a.push(new s.default.Marker(t).setLngLat(e.geometry.coordinates).setPopup(new s.default.Popup({offset:15}).setHTML("<b>"+e.properties.name+"</b><br>"+e.properties.description))),!0}),this.markers.push(a);break;case"trails":var n=[];e.data.features.map(function(e){var t=document.createElement("div");return t.id=r,t.className=r+"-marker",n.push(new s.default.Marker(t).setLngLat([e.properties.lng,e.properties.lat]).setPopup(new s.default.Popup({offset:15}).setHTML("<b>"+e.properties.name+"</b><br>"+e.properties.description))),!0}),this.markers.push(n)}return!0}}]),e}();r.default=o},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(r,t,a){return t&&e(r.prototype,t),a&&e(r,a),r}}(),n=s(t(0)),i=s(t(1));function s(e){return e&&e.__esModule?e:{default:e}}i.default.accessToken=n.default.map.accessToken;var o=function(){function e(r,t,a,s){var o=this;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=r,this.$timeout=t,this.markerService=a,this.splashScreenService=s,this.layers=[],this.layersHash={},this.mapStyle=n.default.map.styles.default,this.map=new i.default.Map({container:n.default.map.container,style:this.mapStyle,center:n.default.map.center,zoom:n.default.map.zoom}).addControl(new i.default.NavigationControl,n.default.map.control.position).on("styledata",function(e){return e.target._loaded&&o.splashScreenService.splashScreen.hasClass("active")&&o.splashScreenService.hideSplashScreen(),!0}).on("load",function(){return o.$http.get(n.default.layers.route,{params:{fields:n.default.layers.biosphere.postgres.fields,table:n.default.layers.biosphere.postgres.table}}).then(function(e){if(e&&e.data){var r=n.default.layers.biosphere.layer;r.source.data=e.data,o.map.addLayer(r),o.layers.push(r)}else console.error("Data Error:\n",e);return!0}).catch(function(e){return console.error("Query Failed:\n",e)}),o.$http.get(n.default.layers.route,{params:{fields:n.default.layers.office.postgres.fields,table:n.default.layers.office.postgres.table}}).then(function(e){return e&&e.data?o.markerService.setMarkers(e):console.error("Data Error:\n",e)}).catch(function(e){return console.error("Query Failed:\n",e)}),o.$http.get(n.default.layers.route,{params:{fields:n.default.layers.places.postgres.fields,table:n.default.layers.places.postgres.table}}).then(function(e){return e&&e.data?o.markerService.setMarkers(e):console.error("Data Error:\n",e)}).catch(function(e){return console.error("Query Failed:\n",e)}),o.$http.get(n.default.layers.route,{params:{fields:n.default.layers.trails.postgres.fields,table:n.default.layers.trails.postgres.table}}).then(function(e){if(e&&e.data){var r=n.default.layers.trails.layer;r.source.data=e.data,o.map.addLayer(r),o.layers.push(r),o.markerService.setMarkers(e)}else console.error("Data Error:\n",e);return!0}).catch(function(e){return console.error("Query Failed:\n",e)}),!0})}return a(e,[{key:"createLayersHash",value:function(){var e=this;return this.layers.map(function(r,t){return e.layersHash[r.id]=t}),!0}},{key:"changeStyle",value:function(){var e=this;return this.splashScreenService.addSplashScreen(),this.mapStyle===n.default.map.styles.default?this.mapStyle=n.default.map.styles.outdoors:this.mapStyle=n.default.map.styles.default,this.map.setStyle(this.mapStyle),this.layers.map(function(r,t){return e.$timeout(function(){return e.map.addLayer(r),"visible"===r.layout.visibility&&e.map.setLayoutProperty(r.id,"visibility","visible"),t===e.layers.length-1&&e.splashScreenService.removeSplashScreen(),!0},1e3)}),!0}}]),e}();r.default=o,o.$inject=["$http","$timeout","markerService","splashScreenService"]},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(r,t,a){return t&&e(r.prototype,t),a&&e(r,a),r}}();var n=function(){function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.restrict="E",this.templateUrl="partials/splashScreen.html",this.controller="splashScreenController as splash"}return a(e,[{key:"link",value:function(e,r){return e.splash.splashScreenService.setSplashScreen(r.children()),!0}}]),e}();r.default=n},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.restrict="E",this.templateUrl="partials/mapTrail.html",this.controller="trailController as trails"}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.restrict="E",this.templateUrl="partials/mapLayer.html",this.controller="layerController as layers"}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.splashScreenService=r};r.default=a,a.$inject=["splashScreenService"]},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a,n=function(){function e(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(r,t,a){return t&&e(r.prototype,t),a&&e(r,a),r}}(),i=t(0),s=(a=i)&&a.__esModule?a:{default:a};var o=function(){function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.mapService=r,this.selectedOption=s.default.trails.selectedOption}return n(e,[{key:"setTrail",value:function(e){switch(e&&e.stopPropagation(),this.selectedOption){case"Blue Mountain":this.mapService.map.flyTo(s.default.trails["Blue Mountain"]);break;case"Charleston Lake":this.mapService.map.flyTo(s.default.trails["Charleston Lake"]);break;case"Lemoine Point":this.mapService.map.flyTo(s.default.trails["Lemoine Point"]);break;case"Lyn Valley":this.mapService.map.flyTo(s.default.trails["Lyn Valley"]);break;case"Mac Johnson":this.mapService.map.flyTo(s.default.trails["Mac Johnson"]);break;case"Seeley's Bay":this.mapService.map.flyTo(s.default.trails["Seeley's Bay"])}return!0}}]),e}();r.default=o,o.$inject=["mapService"]},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a,n=function(){function e(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(r,t,a){return t&&e(r.prototype,t),a&&e(r,a),r}}(),i=t(0),s=(a=i)&&a.__esModule?a:{default:a};var o=function(){function e(r,t,a,n,i,s){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.$document=r,this.$timeout=t,this.$window=a,this.displayMarkerService=n,this.mapService=i,this.markerService=s}return n(e,[{key:"setLayer",value:function(e,r){var t=this;r&&r.stopPropagation(),angular.equals(this.mapService.layersHash,{})&&angular.equals(this.markerService.markersHash,{})&&(this.mapService.createLayersHash(),this.markerService.createMarkersHash());var a=angular.element(this.$document[0].querySelectorAll("map-layer ul.layers li."+e+" div"));return a.hasClass("active")?a.removeClass("active"):a.addClass("active"),"terrain"===e?(this.mapService.changeStyle(),this.displayMarkerService.hideMarkers(),this.mapService.mapStyle===s.default.map.styles.default?this.$timeout(function(){return t.displayMarkerService.showMarkers()},1250):this.$timeout(function(){return t.displayMarkerService.showMarkers()},1500)):"biosphere"===e||"trails"===e?a.hasClass("active")?(this.mapService.map.setLayoutProperty(e,"visibility","visible"),this.mapService.layers[this.mapService.layersHash[e]].layout.visibility="visible","trails"===e&&this.displayMarkerService.addMarkers(e)):(this.mapService.map.setLayoutProperty(e,"visibility","none"),this.mapService.layers[this.mapService.layersHash[e]].layout.visibility="none","trails"===e&&this.displayMarkerService.removeMarkers(e)):"office"===e||"places"===e?a.hasClass("active")?this.displayMarkerService.addMarkers(e):this.displayMarkerService.removeMarkers(e):"resetMap"===e&&this.$window.location.reload(!0),!0}}]),e}();r.default=o,o.$inject=["$document","$timeout","$window","displayMarkerService","mapService","markerService"]},,,function(e,r,t){"use strict";var a=h(t(13)),n=h(t(11)),i=h(t(10)),s=h(t(9)),o=h(t(8)),l=h(t(7)),u=h(t(6)),c=h(t(5)),f=h(t(4)),p=h(t(3)),d=h(t(2));function h(e){return e&&e.__esModule?e:{default:e}}a.default.module("app",[]).controller("layerController",n.default).controller("trailController",i.default).controller("splashScreenController",s.default).directive("mapLayer",function(){return new o.default}).directive("mapTrail",function(){return new l.default}).directive("splashScreen",function(){return new u.default}).service("mapService",c.default).service("markerService",f.default).service("displayMarkerService",p.default).service("splashScreenService",d.default)},function(e,r,t){"use strict";t(14)}]);