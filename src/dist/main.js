!function(e){function r(r){for(var a,o,i=r[0],l=r[1],c=r[2],p=0,f=[];p<i.length;p++)o=i[p],s[o]&&f.push(s[o][0]),s[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(r);f.length;)f.shift()();return n.push.apply(n,c||[]),t()}function t(){for(var e,r=0;r<n.length;r++){for(var t=n[r],a=!0,i=1;i<t.length;i++){var l=t[i];0!==s[l]&&(a=!1)}a&&(n.splice(r--,1),e=o(o.s=t[0]))}return e}var a={},s={1:0},n=[];function o(r){if(a[r])return a[r].exports;var t=a[r]={i:r,l:!1,exports:{}};return e[r].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=e,o.c=a,o.d=function(e,r,t){o.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:t})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(r,"a",r),r},o.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},o.p="";var i=window.webpackJsonp=window.webpackJsonp||[],l=i.push.bind(i);i.push=r,i=i.slice();for(var c=0;c<i.length;c++)r(i[c]);var u=l;n.push([15,0]),t()}([function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.config={map:{accessToken:"pk.eyJ1IjoiZ2Vvc3BhdGlhbHdlYiIsImEiOiJ6WGdOUFRvIn0.GoVRwZq5EfVsLNGyCqgZTw",center:[-76.3,44.45],container:"map",control:{position:"top-left"},styles:{default:"mapbox://styles/mapbox/dark-v9",outdoors:"mapbox://styles/mapbox/outdoors-v9"},zoom:9},layers:{route:"/layers",biosphere:{layer:{id:"biosphere",type:"fill",source:{type:"geojson"},layout:{visibility:"visible"},paint:{"fill-color":"#090","fill-opacity":.3,"fill-outline-color":"#000"}},postgres:{table:"biosphere",fields:"name, description, ST_AsGeoJSON(geom)"}},office:{postgres:{table:"office",fields:"name, description, ST_AsGeoJSON(geom)"}},places:{postgres:{table:"places",fields:"name, description, ST_AsGeoJSON(geom)"}},trails:{layer:{id:"trails",type:"line",source:{type:"geojson"},layout:{visibility:"none"},paint:{"line-color":"#aa0000","line-width":2}},postgres:{table:"trails",fields:"name, description, lat, lng, ST_AsGeoJSON(geom)"}}},trails:{"Blue Mountain":{center:[-76.04,44.508],zoom:12},"Charleston Lake":{center:[-76.04,44.508],zoom:12},"Lemoine Point":{center:[-76.61,44.223],zoom:14},"Lyn Valley":{center:[-75.75,44.575],zoom:12},"Mac Johnson":{center:[-75.75,44.575],zoom:12},"Seeley's Bay":{center:[-76.22,44.485],zoom:13},selectedOption:"Select Trail"}}},,function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.splashScreenService=function(e){var r=this;return r.setSplashScreen=function(e){return r.splashScreen=e},r.addSplashScreen=function(){return r.splashScreen.addClass("visible")},r.removeSplashScreen=function(){return r.splashScreen.removeClass("visible")},r.hideSplashScreen=function(){return r.splashScreen.removeClass("active"),angular.element(e[0].querySelectorAll("map-layer ul.layers li.biosphere div")).addClass("active"),!0},r}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.displayMarkerService=function(e,r,t){var a=this;return a.addMarkers=function(e){return t.markers[t.markersHash[e]].map(function(e){return e.addTo(r.map)})},a.removeMarkers=function(e){return t.markers[t.markersHash[e]].map(function(e){return e.remove()})},a.hideMarkers=function(){return t.markers.map(function(r){var t=r[0].getElement().id;return angular.element(e[0].querySelectorAll("div."+t+"-marker")).length&&(a.removeMarkers(t),r.hidden=!0),!0})},a.showMarkers=function(){return t.markers.map(function(e){if(e.hidden){var r=e[0].getElement().id;a.addMarkers(r),e.hidden=!1}return!0})},a}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.markerService=function(){var e=this;return e.markers=[],e.markersHash={},e.createMarkersHash=function(){return e.markers.map(function(r,t){var a=r[0].getElement();return e.markersHash[a.id]=t,!0})},e.setMarkers=function(r){var t=r.config.params.table;switch(t){case"office":var a=[];r.data.features.map(function(e){var r=document.createElement("div");return r.id=t,r.className=t+"-marker",a.push(new n.default.Marker(r).setLngLat(e.geometry.coordinates).setPopup(new n.default.Popup({offset:15}).setHTML("<b>"+e.properties.name+"</b><br>"+e.properties.description))),!0}),e.markers.push(a);break;case"places":var s=[];r.data.features.map(function(e){var r=document.createElement("div");return r.id=t,r.className=t+"-marker",s.push(new n.default.Marker(r).setLngLat(e.geometry.coordinates).setPopup(new n.default.Popup({offset:15}).setHTML("<b>"+e.properties.name+"</b><br>"+e.properties.description))),!0}),e.markers.push(s);break;case"trails":var o=[];r.data.features.map(function(e){var r=document.createElement("div");return r.id=t,r.className=t+"-marker",o.push(new n.default.Marker(r).setLngLat([e.properties.lng,e.properties.lat]).setPopup(new n.default.Popup({offset:15}).setHTML("<b>"+e.properties.name+"</b><br>"+e.properties.description))),!0}),e.markers.push(o)}return!0},e};var a,s=t(1),n=(a=s)&&a.__esModule?a:{default:a}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mapService=function(e,r,t,a){var n=this;return n.layers=[],n.layersHash={},n.mapStyle=s.config.map.styles.default,n.map=new o.default.Map({container:s.config.map.container,style:n.mapStyle,center:s.config.map.center,zoom:s.config.map.zoom}).addControl(new o.default.NavigationControl,s.config.map.control.position).on("styledata",function(e){return e.target._loaded&&a.splashScreen.hasClass("active")&&a.hideSplashScreen(),!0}).on("load",function(){return e.get(s.config.layers.route,{params:{fields:s.config.layers.biosphere.postgres.fields,table:s.config.layers.biosphere.postgres.table}}).then(function(e){if(e&&e.data){var r=s.config.layers.biosphere.layer;r.source.data=e.data,n.map.addLayer(r),n.layers.push(r)}else console.error("Data Error:\n",e);return!0}).catch(function(e){return console.error("Query Failed:\n",e)}),e.get(s.config.layers.route,{params:{fields:s.config.layers.office.postgres.fields,table:s.config.layers.office.postgres.table}}).then(function(e){return e&&e.data?t.setMarkers(e):console.error("Data Error:\n",e)}).catch(function(e){return console.error("Query Failed:\n",e)}),e.get(s.config.layers.route,{params:{fields:s.config.layers.places.postgres.fields,table:s.config.layers.places.postgres.table}}).then(function(e){return e&&e.data?t.setMarkers(e):console.error("Data Error:\n",e)}).catch(function(e){return console.error("Query Failed:\n",e)}),e.get(s.config.layers.route,{params:{fields:s.config.layers.trails.postgres.fields,table:s.config.layers.trails.postgres.table}}).then(function(e){if(e&&e.data){var r=s.config.layers.trails.layer;r.source.data=e.data,n.map.addLayer(r),n.layers.push(r),t.setMarkers(e)}else console.error("Data Error:\n",e);return!0}).catch(function(e){return console.error("Query Failed:\n",e)}),!0}),n.createLayersHash=function(){return n.layers.map(function(e,r){return n.layersHash[e.id]=r})},n.changeStyle=function(){return a.addSplashScreen(),n.mapStyle===s.config.map.styles.default?n.mapStyle=s.config.map.styles.outdoors:n.mapStyle=s.config.map.styles.default,n.map.setStyle(n.mapStyle),n.layers.map(function(e,t){return r(function(){return n.map.addLayer(e),"visible"===e.layout.visibility&&n.map.setLayoutProperty(e.id,"visibility","visible"),t===n.layers.length-1&&a.removeSplashScreen(),!0},1e3)}),!0},n};var a,s=t(0),n=t(1),o=(a=n)&&a.__esModule?a:{default:a};o.default.accessToken=s.config.map.accessToken},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.splashScreenDirective=function(e,r){return{restrict:"E",templateUrl:e.trustAsResourceUrl("partials/splashScreen.html"),link:function(e,t){return r.setSplashScreen(t.children()),!0}}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mapTrailDirective=function(e){return{restrict:"E",templateUrl:e.trustAsResourceUrl("partials/mapTrail.html"),controller:"trailController as trails"}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mapLayerDirective=function(e){return{restrict:"E",templateUrl:e.trustAsResourceUrl("partials/mapLayer.html"),controller:"layerController as layers"}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.trailController=function(e){var r=this;return r.selectedOption=a.config.trails.selectedOption,r.setTrail=function(t){switch(t&&t.stopPropagation(),r.selectedOption){case"Blue Mountain":e.map.flyTo(a.config.trails["Blue Mountain"]);break;case"Charleston Lake":e.map.flyTo(a.config.trails["Charleston Lake"]);break;case"Lemoine Point":e.map.flyTo(a.config.trails["Lemoine Point"]);break;case"Lyn Valley":e.map.flyTo(a.config.trails["Lyn Valley"]);break;case"Mac Johnson":e.map.flyTo(a.config.trails["Mac Johnson"]);break;case"Seeley's Bay":e.map.flyTo(a.config.trails["Seeley's Bay"])}return!0},r};var a=t(0)},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.layerController=function(e,r,t,s,n,o){return this.setLayer=function(i,l){l&&l.stopPropagation(),angular.equals(n.layersHash,{})&&angular.equals(o.markersHash,{})&&(n.createLayersHash(),o.createMarkersHash());var c=angular.element(e[0].querySelectorAll("map-layer ul.layers li."+i+" div"));return c.hasClass("active")?c.removeClass("active"):c.addClass("active"),"terrain"===i?(n.changeStyle(),s.hideMarkers(),n.mapStyle===a.config.map.styles.default?r(function(){return s.showMarkers()},1250):r(function(){return s.showMarkers()},1500)):"biosphere"===i||"trails"===i?c.hasClass("active")?(n.map.setLayoutProperty(i,"visibility","visible"),n.layers[n.layersHash[i]].layout.visibility="visible","trails"===i&&s.addMarkers(i)):(n.map.setLayoutProperty(i,"visibility","none"),n.layers[n.layersHash[i]].layout.visibility="none","trails"===i&&s.removeMarkers(i)):"office"===i||"places"===i?c.hasClass("active")?s.addMarkers(i):s.removeMarkers(i):"resetMap"===i&&t.location.reload(!0),!0},this};var a=t(0)},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mapController=function(){return this}},,,function(e,r,t){"use strict";var a,s=t(13),n=(a=s)&&a.__esModule?a:{default:a},o=t(11),i=t(10),l=t(9),c=t(8),u=t(7),p=t(6),f=t(5),d=t(4),m=t(3),y=t(2);n.default.module("app",[]).controller("mapController",o.mapController).controller("layerController",i.layerController).controller("trailController",l.trailController).directive("mapLayer",c.mapLayerDirective).directive("mapTrail",u.mapTrailDirective).directive("splashScreen",p.splashScreenDirective).service("mapService",f.mapService).service("markerService",d.markerService).service("displayMarkerService",m.displayMarkerService).service("splashScreenService",y.splashScreenService)},function(e,r,t){"use strict";t(14)}]);