!function(e){function r(r){for(var a,n,i=r[0],l=r[1],c=r[2],p=0,f=[];p<i.length;p++)n=i[p],s[n]&&f.push(s[n][0]),s[n]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(r);f.length;)f.shift()();return o.push.apply(o,c||[]),t()}function t(){for(var e,r=0;r<o.length;r++){for(var t=o[r],a=!0,i=1;i<t.length;i++){var l=t[i];0!==s[l]&&(a=!1)}a&&(o.splice(r--,1),e=n(n.s=t[0]))}return e}var a={},s={1:0},o=[];function n(r){if(a[r])return a[r].exports;var t=a[r]={i:r,l:!1,exports:{}};return e[r].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=e,n.c=a,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:t})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="";var i=window.webpackJsonp=window.webpackJsonp||[],l=i.push.bind(i);i.push=r,i=i.slice();for(var c=0;c<i.length;c++)r(i[c]);var u=l;o.push([15,0]),t()}([function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.config={map:{accessToken:"pk.eyJ1IjoiZ2Vvc3BhdGlhbHdlYiIsImEiOiJ6WGdOUFRvIn0.GoVRwZq5EfVsLNGyCqgZTw",center:[-76.3,44.45],container:"map",control:{position:"top-left"},styles:{default:"mapbox://styles/mapbox/dark-v9",outdoors:"mapbox://styles/mapbox/outdoors-v9"},zoom:9},layers:{route:"/layers",biosphere:{layer:{id:"biosphere",type:"fill",source:{type:"geojson"},layout:{visibility:"visible"},paint:{"fill-color":"#090","fill-opacity":.3,"fill-outline-color":"#000"}},postgres:{table:"biosphere",fields:"name, description, ST_AsGeoJSON(geom)"}},office:{postgres:{table:"office",fields:"name, description, ST_AsGeoJSON(geom)"}},places:{postgres:{table:"places",fields:"name, description, ST_AsGeoJSON(geom)"}},trails:{layer:{id:"trails",type:"line",source:{type:"geojson"},layout:{visibility:"none"},paint:{"line-color":"#aa0000","line-width":2}},postgres:{table:"trails",fields:"name, description, lat, lng, ST_AsGeoJSON(geom)"}}},trails:{Blue_Mountain:{center:[-76.04,44.508],zoom:12},Charleston_Lake:{center:[-76.04,44.508],zoom:12},Lemoine_Point:{center:[-76.61,44.223],zoom:14},Lyn_Valley:{center:[-75.75,44.575],zoom:12},Mac_Johnson:{center:[-75.75,44.575],zoom:12},Seeleys_Bay:{center:[-76.22,44.485],zoom:13},selectedOption:"Select Trail"}}},,function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.splashScreenService=function(e){var r=this;return r.hideSplashScreen=function(){return r.splashScreen.removeClass("visible"),angular.element(e[0].querySelectorAll("map-layer ul.layers li.biosphere div")).addClass("active"),!0},r.setSplashScreen=function(e){return r.splashScreen=e},r.addSplashScreen=function(){return r.splashScreen.addClass("active")},r.removeSplashScreen=function(){return r.splashScreen.removeClass("active")},r}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.displayMarkerService=function(e,r,t){var a=[],s=this;return s.addMarkers=function(e){return t.markers[t.markersHash[e]].forEach(function(e){return e.addTo(r.map)})},s.removeMarkers=function(e){return t.markers[t.markersHash[e]].forEach(function(e){return e.remove()})},s.hideMarkers=function(){return t.markers.forEach(function(r){var t=r[0].getElement().id;return angular.element(e[0].querySelectorAll("div."+t+"-marker")).length&&(s.removeMarkers(t),a.push(r)),!0})},s.showMarkers=function(){return a.length&&(a.forEach(function(e){var r=e[0].getElement().id;return s.addMarkers(r),!0}),a=[]),!0},s}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.markerService=function(){var e=this;return e.markers=[],e.markersHash={},e.createMarkersHash=function(){return e.markers.forEach(function(r,t){var a=r[0].getElement();return e.markersHash[a.id]=t,!0})},e.setMarkers=function(r){var t=r.config.params.table;switch(t){case"office":var a=[];r.data.features.forEach(function(e){var r=document.createElement("div");return r.id=t,r.className=t+"-marker",a.push(new o.default.Marker(r).setLngLat(e.geometry.coordinates).setPopup(new o.default.Popup({offset:15}).setHTML("<b>"+e.properties.name+"</b><br>"+e.properties.description))),!0}),e.markers.push(a);break;case"places":var s=[];r.data.features.forEach(function(e){var r=document.createElement("div");return r.id=t,r.className=t+"-marker",s.push(new o.default.Marker(r).setLngLat(e.geometry.coordinates).setPopup(new o.default.Popup({offset:15}).setHTML("<b>"+e.properties.name+"</b><br>"+e.properties.description))),!0}),e.markers.push(s);break;case"trails":var n=[];r.data.features.forEach(function(e){var r=document.createElement("div");return r.id=t,r.className=t+"-marker",n.push(new o.default.Marker(r).setLngLat([e.properties.lng,e.properties.lat]).setPopup(new o.default.Popup({offset:15}).setHTML("<b>"+e.properties.name+"</b><br>"+e.properties.description))),!0}),e.markers.push(n)}return!0},e};var a,s=t(1),o=(a=s)&&a.__esModule?a:{default:a}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mapService=function(e,r,t,a){var o=this;return o.layers=[],o.layersHash={},o.mapStyle=s.config.map.styles.default,o.map=new n.default.Map({container:s.config.map.container,style:o.mapStyle,center:s.config.map.center,zoom:s.config.map.zoom}).addControl(new n.default.NavigationControl,s.config.map.control.position).on("styledata",function(e){return e.target._loaded&&a.splashScreen.hasClass("visible")&&a.hideSplashScreen(),!0}).on("load",function(){return e.get(s.config.layers.route,{params:{fields:s.config.layers.biosphere.postgres.fields,table:s.config.layers.biosphere.postgres.table}}).then(function(e){if(e&&e.data){var r=s.config.layers.biosphere.layer;r.source.data=e.data,o.map.addLayer(r),o.layers.push(r)}else console.error("Data Error:\n",e);return!0}).catch(function(e){return console.error("Query Failed:\n",e)}),e.get(s.config.layers.route,{params:{fields:s.config.layers.office.postgres.fields,table:s.config.layers.office.postgres.table}}).then(function(e){return e&&e.data?t.setMarkers(e):console.error("Data Error:\n",e)}).catch(function(e){return console.error("Query Failed:\n",e)}),e.get(s.config.layers.route,{params:{fields:s.config.layers.places.postgres.fields,table:s.config.layers.places.postgres.table}}).then(function(e){return e&&e.data?t.setMarkers(e):console.error("Data Error:\n",e)}).catch(function(e){return console.error("Query Failed:\n",e)}),e.get(s.config.layers.route,{params:{fields:s.config.layers.trails.postgres.fields,table:s.config.layers.trails.postgres.table}}).then(function(e){if(e&&e.data){var r=s.config.layers.trails.layer;r.source.data=e.data,o.map.addLayer(r),o.layers.push(r),t.setMarkers(e)}else console.error("Data Error:\n",e);return!0}).catch(function(e){return console.error("Query Failed:\n",e)}),!0}),o.createLayersHash=function(){return o.layers.forEach(function(e,r){return o.layersHash[e.id]=r})},o.changeStyle=function(){return a.addSplashScreen(),o.mapStyle===s.config.map.styles.default?o.mapStyle=s.config.map.styles.outdoors:o.mapStyle=s.config.map.styles.default,o.map.setStyle(o.mapStyle),o.layers.forEach(function(e,t){return r(function(){return o.map.addLayer(e),"visible"===e.layout.visibility&&o.map.setLayoutProperty(e.id,"visibility","visible"),t===o.layers.length-1&&a.removeSplashScreen(),!0},1e3)}),!0},o};var a,s=t(0),o=t(1),n=(a=o)&&a.__esModule?a:{default:a};n.default.accessToken=s.config.map.accessToken},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.splashScreenDirective=function(e,r){return{restrict:"E",templateUrl:e.trustAsResourceUrl("partials/splashScreen.html"),link:function(e,t){return r.setSplashScreen(t.children()),!0}}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mapTrailDirective=function(e){return{restrict:"E",templateUrl:e.trustAsResourceUrl("partials/mapTrail.html"),controller:"trailController as trails"}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mapLayerDirective=function(e){return{restrict:"E",templateUrl:e.trustAsResourceUrl("partials/mapLayer.html"),controller:"layerController as layers"}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.trailController=function(e){var r=this;return r.selectedOption=a.config.trails.selectedOption,r.setTrail=function(t){switch(t&&t.stopPropagation(),r.selectedOption){case"Blue Mountain":e.map.flyTo(a.config.trails.Blue_Mountain);break;case"Charleston Lake":e.map.flyTo(a.config.trails.Charleston_Lake);break;case"Lemoine Point":e.map.flyTo(a.config.trails.Lemoine_Point);break;case"Lyn Valley":e.map.flyTo(a.config.trails.Lyn_Valley);break;case"Mac Johnson":e.map.flyTo(a.config.trails.Mac_Johnson);break;case"Seeley's Bay":e.map.flyTo(a.config.trails.Seeleys_Bay)}return!0},r};var a=t(0)},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.layerController=function(e,r,t,s,o,n){return this.setLayer=function(i,l){l&&l.stopPropagation(),angular.equals(o.layersHash,{})&&angular.equals(n.markersHash,{})&&(o.createLayersHash(),n.createMarkersHash());var c=angular.element(e[0].querySelectorAll("map-layer ul.layers li."+i+" div"));return c.hasClass("active")?c.removeClass("active"):c.addClass("active"),"terrain"===i?(o.changeStyle(),s.hideMarkers(),o.mapStyle===a.config.map.styles.default?r(function(){return s.showMarkers()},1250):r(function(){return s.showMarkers()},1500)):"biosphere"===i||"trails"===i?c.hasClass("active")?(o.map.setLayoutProperty(i,"visibility","visible"),o.layers[o.layersHash[i]].layout.visibility="visible","trails"===i&&s.addMarkers(i)):(o.map.setLayoutProperty(i,"visibility","none"),o.layers[o.layersHash[i]].layout.visibility="none","trails"===i&&s.removeMarkers(i)):"office"===i||"places"===i?c.hasClass("active")?s.addMarkers(i):s.removeMarkers(i):"resetMap"===i&&t.location.reload(!0),!0},this};var a=t(0)},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mapController=function(){return this}},,,function(e,r,t){"use strict";var a,s=t(13),o=(a=s)&&a.__esModule?a:{default:a},n=t(11),i=t(10),l=t(9),c=t(8),u=t(7),p=t(6),f=t(5),d=t(4),y=t(3),m=t(2);o.default.module("app",[]).controller("mapController",n.mapController).controller("layerController",i.layerController).controller("trailController",l.trailController).directive("mapLayer",c.mapLayerDirective).directive("mapTrail",u.mapTrailDirective).directive("splashScreen",p.splashScreenDirective).service("mapService",f.mapService).service("markerService",d.markerService).service("displayMarkerService",y.displayMarkerService).service("splashScreenService",m.splashScreenService)},function(e,r,t){"use strict";t(14)}]);